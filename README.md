# otus_18
# Архитектура сетей

# Дано
https://github.com/erlong15/otus-linux/tree/network
(ветка network)

Vagrantfile с начальным построением сети
- inetRouter
- centralRouter
- centralServer

# Планируемая архитектура

Сеть office1
- 192.168.2.0/26 - dev
- 192.168.2.64/26 - test servers
- 192.168.2.128/26 - managers
- 192.168.2.192/26 - office hardware

Сеть office2
- 192.168.1.0/25 - dev
- 192.168.1.128/26 - test servers
- 192.168.1.192/26 - office hardware

Сеть central
- 192.168.0.0/28 - directors
- 192.168.0.32/28 - office hardware
- 192.168.0.64/26 - wifi

```
Office1 ---\
-----> Central --IRouter --> internet
Office2----/
```
Итого должны получится следующие сервера
- inetRouter
- centralRouter
- office1Router
- office2Router
- centralServer
- office1Server
- office2Server

# Теоретическая часть
- Найти свободные подсети
- Посчитать сколько узлов в каждой подсети, включая свободные
- Указать broadcast адрес для каждой подсети
- проверить нет ли ошибок при разбиении

# Практическая часть
- Соединить офисы в сеть согласно схеме и настроить роутинг
- Все сервера и роутеры должны ходить в инет черз inetRouter
- Все сервера должны видеть друг друга
- у всех новых серверов отключить дефолт на нат (eth0), который вагрант поднимает для связи
- при нехватке сетевых интервейсов добавить по несколько адресов на интерфейс

________________________________________________________________________________________________

# Итог
# Теоретическая часть
- Найти свободные подсети
- Посчитать сколько узлов в каждой подсети, включая свободные
- Указать broadcast адрес для каждой подсети
- проверить нет ли ошибок при разбиении

```
# Сеть Central
Свободные подсети есть, указаны в конце списка.
Всего 246 узлов =14 + 14 + 62 + 14 + 14 + 126
- 192.168.0.0/28 - directors

Address:   192.168.0.0           11000000.10101000.00000000.0000 0000
Netmask:   255.255.255.240 = 28  11111111.11111111.11111111.1111 0000
Wildcard:  0.0.0.15              00000000.00000000.00000000.0000 1111
=>
Network:   192.168.0.0/28        11000000.10101000.00000000.0000 0000 (Class C)
Broadcast: 192.168.0.15          11000000.10101000.00000000.0000 1111
HostMin:   192.168.0.1           11000000.10101000.00000000.0000 0001
HostMax:   192.168.0.14          11000000.10101000.00000000.0000 1110
Hosts/Net: 14                    (Private Internet)

- 192.168.0.32/28 - office hardware

Address:   192.168.0.32          11000000.10101000.00000000.0010 0000
Netmask:   255.255.255.240 = 28  11111111.11111111.11111111.1111 0000
Wildcard:  0.0.0.15              00000000.00000000.00000000.0000 1111
=>
Network:   192.168.0.32/28       11000000.10101000.00000000.0010 0000 (Class C)
Broadcast: 192.168.0.47          11000000.10101000.00000000.0010 1111
HostMin:   192.168.0.33          11000000.10101000.00000000.0010 0001
HostMax:   192.168.0.46          11000000.10101000.00000000.0010 1110
Hosts/Net: 14                    (Private Internet)

- 192.168.0.64/26 - wifi

Address:   192.168.0.64          11000000.10101000.00000000.01 000000
Netmask:   255.255.255.192 = 26  11111111.11111111.11111111.11 000000
Wildcard:  0.0.0.63              00000000.00000000.00000000.00 111111
=>
Network:   192.168.0.64/26       11000000.10101000.00000000.01 000000 (Class C)
Broadcast: 192.168.0.127         11000000.10101000.00000000.01 111111
HostMin:   192.168.0.65          11000000.10101000.00000000.01 000001
HostMax:   192.168.0.126         11000000.10101000.00000000.01 111110
Hosts/Net: 62                    (Private Internet)

Свободные подсети
1) 
Address:   192.168.0.16          11000000.10101000.00000000.0001 0000
Netmask:   255.255.255.240 = 28  11111111.11111111.11111111.1111 0000
Wildcard:  0.0.0.15              00000000.00000000.00000000.0000 1111
=>
Network:   192.168.0.16/28       11000000.10101000.00000000.0001 0000 (Class C)
Broadcast: 192.168.0.31          11000000.10101000.00000000.0001 1111
HostMin:   192.168.0.17          11000000.10101000.00000000.0001 0001
HostMax:   192.168.0.30          11000000.10101000.00000000.0001 1110
Hosts/Net: 14                    (Private Internet)

2) 
Address:   192.168.0.48          11000000.10101000.00000000.0011 0000
Netmask:   255.255.255.240 = 28  11111111.11111111.11111111.1111 0000
Wildcard:  0.0.0.15              00000000.00000000.00000000.0000 1111
=>
Network:   192.168.0.48/28       11000000.10101000.00000000.0011 0000 (Class C)
Broadcast: 192.168.0.63          11000000.10101000.00000000.0011 1111
HostMin:   192.168.0.49          11000000.10101000.00000000.0011 0001
HostMax:   192.168.0.62          11000000.10101000.00000000.0011 1110
Hosts/Net: 14                    (Private Internet)

3)
Address:   192.168.0.128         11000000.10101000.00000000.1 0000000
Netmask:   255.255.255.128 = 25  11111111.11111111.11111111.1 0000000
Wildcard:  0.0.0.127             00000000.00000000.00000000.0 1111111
=>
Network:   192.168.0.128/25      11000000.10101000.00000000.1 0000000 (Class C)
Broadcast: 192.168.0.255         11000000.10101000.00000000.1 1111111
HostMin:   192.168.0.129         11000000.10101000.00000000.1 0000001
HostMax:   192.168.0.254         11000000.10101000.00000000.1 1111110
Hosts/Net: 126                   (Private Internet)

# Сеть office1
Свободных подсетей нет.
Всего 248 узлов = 62 + 62 + 62 + 62

- 192.168.2.0/26 - dev

Address:   192.168.2.0           11000000.10101000.00000010.00 000000
Netmask:   255.255.255.192 = 26  11111111.11111111.11111111.11 000000
Wildcard:  0.0.0.63              00000000.00000000.00000000.00 111111
=>
Network:   192.168.2.0/26        11000000.10101000.00000010.00 000000 (Class C)
Broadcast: 192.168.2.63          11000000.10101000.00000010.00 111111
HostMin:   192.168.2.1           11000000.10101000.00000010.00 000001
HostMax:   192.168.2.62          11000000.10101000.00000010.00 111110
Hosts/Net: 62                    (Private Internet)

- 192.168.2.64/26 - test servers

Address:   192.168.2.64          11000000.10101000.00000010.01 000000
Netmask:   255.255.255.192 = 26  11111111.11111111.11111111.11 000000
Wildcard:  0.0.0.63              00000000.00000000.00000000.00 111111
=>
Network:   192.168.2.64/26       11000000.10101000.00000010.01 000000 (Class C)
Broadcast: 192.168.2.127         11000000.10101000.00000010.01 111111
HostMin:   192.168.2.65          11000000.10101000.00000010.01 000001
HostMax:   192.168.2.126         11000000.10101000.00000010.01 111110
Hosts/Net: 62                    (Private Internet)

- 192.168.2.128/26 - managers

Address:   192.168.2.128         11000000.10101000.00000010.10 000000
Netmask:   255.255.255.192 = 26  11111111.11111111.11111111.11 000000
Wildcard:  0.0.0.63              00000000.00000000.00000000.00 111111
=>
Network:   192.168.2.128/26      11000000.10101000.00000010.10 000000 (Class C)
Broadcast: 192.168.2.191         11000000.10101000.00000010.10 111111
HostMin:   192.168.2.129         11000000.10101000.00000010.10 000001
HostMax:   192.168.2.190         11000000.10101000.00000010.10 111110
Hosts/Net: 62                    (Private Internet)

- 192.168.2.192/26 - office hardware

Address:   192.168.2.192         11000000.10101000.00000010.11 000000
Netmask:   255.255.255.192 = 26  11111111.11111111.11111111.11 000000
Wildcard:  0.0.0.63              00000000.00000000.00000000.00 111111
=>
Network:   192.168.2.192/26      11000000.10101000.00000010.11 000000 (Class C)
Broadcast: 192.168.2.255         11000000.10101000.00000010.11 111111
HostMin:   192.168.2.193         11000000.10101000.00000010.11 000001
HostMax:   192.168.2.254         11000000.10101000.00000010.11 111110
Hosts/Net: 62                    (Private Internet)

```

# Практическая часть
[Vagrantfile](https://github.com/Edo1993/otus_18/blob/master/Vagrantfile) , который всё разворачивает

```ip route``` на centralRouter, office1Router, office2Router
![Image_alt](https://github.com/Edo1993/otus_18/blob/master/181.png)
